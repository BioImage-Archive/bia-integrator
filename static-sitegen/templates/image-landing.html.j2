<html lang="en" class="vf-no-js">
    <head>
        <meta charset="UTF-8">
        <link rel="stylesheet" href="https://assets.emblstatic.net/vf/v2.5.8/css/styles.css">
        <title>{{ image.id }}</title>
    </head>

    <body>
        <header class="vf-global-header">
            <!-- <a href="https://www.ebi.ac.uk/bioimage-archive" class="vf-logo | vf-logo--has--text">
                <img class="vf-logo__image" src="https://uk1s3.embassy.ebi.ac.uk/bia-zarr-test/images/BIA-Logo.png">
                <div class="vf-logo__text">BioImage Archive</div>
            </a> -->
            <header class="vf-global-header">

                <div class="vf-global-header__inner">
          
                  <a href="http://www.embl.de" class="vf-logo">
                    <img class="vf-logo__image" src="images/BIA-Logo.png" alt="BioImage Archive">
                    <span class="vf-logo__text">   BioImage Archive</span>
                  </a>
          
                </div>
          
            </header>
        </header>

        <div class="vf-stack vf-stack--500">
            <section class="vf-intro | embl-grid embl-grid--has-centered-content">
                <div></div>
                <div>
                    <h1 class="vf-intro__heading vf-intro__heading--has-tag">{{ study.accession_id }}:{{ image.id }}<a href="JavaScript:Void(0);" class="vf-badge vf-badge--primary vf-badge--phases">alpha</a></h1>
                    <h2 class="vf-intro__subheading">{{ image.original_relpath }}</h2>
                    <p>Study Title: {{ study.title }}</p>
                    <p>Organism: {{ study.organism }}</p>
                    <figure class="vf-figure vf-figure--align vf-figure--align-centered">
                        <img class="vf-figure__image" src="{{ image_uri }}">
                    </figure>  

                </div>
                <div></div>
            </section>
            <!-- Study information -->
            <section class="vf-content | embl-grid embl-grid--has-centered-content">
                <div>
                    <button class="vf-button vf-button--primary vf-button--sm" onclick="copyTextToClipboard('{{ zarr_uri }}')">Copy S3 URI to clipboard</button>
                    <button class="vf-button vf-button--primary vf-button--sm" onclick="location.href='https://kitware.github.io/itk-vtk-viewer/app/?fileToLoad={{ zarr_uri }}';">Open in ITK viewer</button>
                    <button class="vf-button vf-button--primary vf-button--sm" onclick="location.href='https://hms-dbmi.github.io/vizarr/?source={{ zarr_uri }}';">Open fullscreen in Vizarr</button>
                </div>
                <div>
                    <iframe style="width: 100%; height: 500px" name="vizarr" src="https://uk1s3.embassy.ebi.ac.uk/bia-zarr-test/vizarr/index.html?source={{ zarr_uri }}"></iframe>
                </div>

                <div>
                    <h2 class="vf-section-header__heading">Image metadata</h2>
                    <p></p>
                    {% if not dimensions %}
                        {% if image.attributes.get('SizeX') %}
                            {% if image.attributes['SizeZ'] != 1 %}
                                Dimensions: {{ image.attributes['SizeX'] }} x {{ image.attributes['SizeY'] }} x {{ image.attributes['SizeZ'] }}
                            {% else %}
                                Dimensions: {{ image.attributes['SizeX'] }} x {{ image.attributes['SizeY'] }}
                            {% endif %}
                        {% else %}
                            Dimensions : {{ dimensions }}
                        {% endif %}
                    {% else %}
                        Dimensions : {{ dimensions }}
                    {% endif %}
                    {% if image.attributes.get('SizeC') %}
                        <div> Number of Channels : {{ image.attributes['SizeC'] }} </div>
                    {% endif %}
                    {% if image.attributes.get('SizeT') %}
                        {% if image.attributes['SizeT'] != 1 %}
                            <div> Number of Time Points : {{ image.attributes['SizeT'] }} </div>
                        {% endif %}
                    {% endif %}
                    {% if psize != None %}
                        <div> Physical Dimensions : {{ psize }} </div>
                    {% endif %}
                    {% for key, value in image.attributes.items() %}
                        {% if 'Size' not in key %} 
                            {% if key not in ['DimensionOrder','md5'] %}
                                <div> {{key}} : {{value}} </div>
                            {% endif %}
                        {% endif %}
                    {% endfor %}
                </div>
                <div>
                    <div class="vf-content">
                        <div class="vf-grid vf-grid__col-2">

                        </div>
                    </div>
                </div>
                <div></div>
            </section>
 
        </div>
    </body>
    <script>
                    function copyTextToClipboard(text) {
                    var textArea = document.createElement("textarea");
                    // Place in the top-left corner of screen regardless of scroll position.
                    textArea.style.position = 'fixed';

                    textArea.value = text;

                    document.body.appendChild(textArea);
                    textArea.focus();
                    textArea.select();

                    var successful;
                    try {
                        successful = document.execCommand('copy');
                    } catch (err) {
                        console.log('Oops, unable to copy');
                    }
                    document.body.removeChild(textArea);

                    if (successful) {
                        // show user that copying happened - update text on element (e.g. button)
                        let target = event.target;
                        let html = target.innerHTML;
                        target.classList.add("shake");
                        setTimeout(() => {
                            // reset after 1 second
                            target.classList.remove("shake");
                        }, 1000)
                    } else {
                        console.log("Copying failed")
                    }
                }
    </script>
    <script type="text/javascript" src="https://kitware.github.io/itk-vtk-viewer/app/itkVtkViewerCDN.js"></script>
</html>