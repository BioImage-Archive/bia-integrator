<html lang="en" class="vf-no-js">
    <head>
        <meta charset="UTF-8">
        <link rel="stylesheet" href="https://assets.emblstatic.net/vf/v2.5.8/css/styles.css">
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
        <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/dt/dt-1.11.5/datatables.min.css"/>
        <script type="text/javascript" src="https://cdn.datatables.net/v/dt/dt-1.11.5/datatables.min.js"></script>
        <script type="text/javascript" src="https://cdn.datatables.net/plug-ins/1.13.1/sorting/natural.js"></script>
        <meta charset="UTF-8">
        <title>{{ accession_id }}</title>
    </head>

    <body>
        <header class="vf-global-header">
            <header class="vf-global-header">

                <div class="vf-global-header__inner">
          
                  <a href="https://www.ebi.ac.uk/bioimage-archive/" class="vf-logo">
                    <img class="vf-logo__image" src="/bia-integrator-data/pages/assets/BIA-Logo.png" alt="BioImage Archive"> 
                    <!-- <img class="vf-logo__image" src="/Users/aybuke/work/ebi/BIA_curated_sets/BIA-Logo.png" alt="BioImage Archive"> -->
                    <span class="vf-logo__text">   BioImage Archive</span>
                  </a>
          
                </div>
          
            </header>
        </header>

<!-- <nav class="vf-navigation vf-navigation--main | vf-cluster">
  <ul class="vf-navigation__list | vf-list | vf-cluster__inner">
    <li class="vf-navigation__item">
      <a href="JavaScript:Void(0);" class="vf-navigation__link" aria-current="page">Home</a>
    </li>    <li class="vf-navigation__item">
      <a href="JavaScript:Void(0);" class="vf-navigation__link">Download</a>
    </li>    <li class="vf-navigation__item">
      <a href="JavaScript:Void(0);" class="vf-navigation__link">Release Notes</a>
    </li>    <li class="vf-navigation__item">
      <a href="JavaScript:Void(0);" class="vf-navigation__link">FAQ</a>
    </li>    <li class="vf-navigation__item">
      <a href="JavaScript:Void(0);" class="vf-navigation__link">Help</a>
    </li>    <li class="vf-navigation__item">
      <a href="JavaScript:Void(0);" class="vf-navigation__link">Licence</a>
    </li>    <li class="vf-navigation__item">
      <a href="JavaScript:Void(0);" class="vf-navigation__link">About</a>
    </li>    <li class="vf-navigation__item">
      <a href="JavaScript:Void(0);" class="vf-navigation__link">Feedback</a>
    </li>  </ul>
</nav>
-->

<section class="vf-intro">

  <div><!-- empty --></div>

  <div class="vf-stack">

  <h1 class="vf-intro__heading ">{{ study.accession_id }}</h1>
  <h2 class="vf-intro__subheading">{{ study.title }}</h2>
     Released: {{ study.release_date }} <br>
    By: {{ authors }}
  </div>
</section>

<section class="embl-grid">
    <h3 class="vf-links__heading">On this page</h3>
    <div class="vf-links vf-links__list--easy">
      <ul class="vf-links__list | vf-list">
        <li class="vf-list__item">
          <a class="vf-list__link" href="#study">
            Study Information
            <svg class="vf-icon vf-icon__arrown--down | vf-list__icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M.249,7.207,11.233,19.678h0a1.066,1.066,0,0,0,1.539,0L23.751,7.207a.987.987,0,0,0-.107-1.414l-1.85-1.557a1.028,1.028,0,0,0-1.438.111L12.191,13.8a.25.25,0,0,1-.379,0L3.644,4.346A1.021,1.021,0,0,0,2.948,4a1,1,0,0,0-.741.238L.356,5.793A.988.988,0,0,0,0,6.478.978.978,0,0,0,.249,7.207Z"></path></svg>
          </a>
        </li>
        <li class="vf-list__item">
          <a class="vf-list__link" href="#images">
            Images
            <svg class="vf-icon vf-icon__arrown--down | vf-list__icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M.249,7.207,11.233,19.678h0a1.066,1.066,0,0,0,1.539,0L23.751,7.207a.987.987,0,0,0-.107-1.414l-1.85-1.557a1.028,1.028,0,0,0-1.438.111L12.191,13.8a.25.25,0,0,1-.379,0L3.644,4.346A1.021,1.021,0,0,0,2.948,4a1,1,0,0,0-.741.238L.356,5.793A.988.988,0,0,0,0,6.478.978.978,0,0,0,.249,7.207Z"></path></svg>
          </a>
        </li>
        <li class="vf-list__item">
          <a class="vf-list__link" href="#annotations">
            Annotations
            <svg class="vf-icon vf-icon__arrown--down | vf-list__icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M.249,7.207,11.233,19.678h0a1.066,1.066,0,0,0,1.539,0L23.751,7.207a.987.987,0,0,0-.107-1.414l-1.85-1.557a1.028,1.028,0,0,0-1.438.111L12.191,13.8a.25.25,0,0,1-.379,0L3.644,4.346A1.021,1.021,0,0,0,2.948,4a1,1,0,0,0-.741.238L.356,5.793A.988.988,0,0,0,0,6.478.978.978,0,0,0,.249,7.207Z"></path></svg>
          </a>
        </li>
        <li class="vf-list__item">
          <a class="vf-list__link" href="#models">
            Models used
            <svg class="vf-icon vf-icon__arrown--down | vf-list__icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M.249,7.207,11.233,19.678h0a1.066,1.066,0,0,0,1.539,0L23.751,7.207a.987.987,0,0,0-.107-1.414l-1.85-1.557a1.028,1.028,0,0,0-1.438.111L12.191,13.8a.25.25,0,0,1-.379,0L3.644,4.346A1.021,1.021,0,0,0,2.948,4a1,1,0,0,0-.741.238L.356,5.793A.988.988,0,0,0,0,6.478.978.978,0,0,0,.249,7.207Z"></path></svg>
          </a>
        </li>
      </ul>
    </div>
  </section>

  <div class="embl-grid embl-grid--has-centered-content">
    <div class="vf-section-header">
      <h2 class="vf-section-header__heading">
      In a nutshell
      </h2>
<ul class="vf-list">
        {% if annotation_names|length > 0 %}
        <li>{{ non_annotation_names|length }} images</li>
        <li>{{ annotation_names|length }} annotations</li>
        {% else %}
        <li>{{ study.images|length }} images</li>
        {% endif %}
        {% if study.archive_files|length > 0 %}
        <li>{{ study.archive_files|length }} archive files</li>
        {% endif %}
        {% if study.other_files|length > 0 %}
       <li>{{ study.other_files|length }} other files</li>
        {% endif %}
        <li><b>License : {{ study.license }} </b><li>
        </ul>
        <h2 class="vf-section-header__heading">This dataset has</h2>
        <ul class="vf-list">
        {% for value in study.tags %}
        {% if value.startswith('AI') %}
        <li>{{ value[2:] }}</li>
        {% else %}
        <li>{{ value }}</li>
        {% endif %}
        {% endfor %}
        </ul>
        {% if 'bia_binder_url' in study.attributes %}
            <a href={{ study.attributes['bia_binder_url'] }}><button class="vf-button vf-button--primary vf-button--sm">Explore in BIA Binder</button></a>
        {% endif %}
    </div>
      <div>
    <table class="vf-table--striped">
    <colgroup>
      <col span="1" style="width: 50%;">
      <col span="1" style="width: 50%;">                         
    </colgroup>
    <tr class="vf-table__row">  
    <td class="vf-table__cell">             
      <figure class="vf-figure">
        <img class="vf-figure__image" src="{{ study.example_image_uri }}" alt="Example image for this dataset">
        <figcaption class="vf-figure__caption">Example image for this dataset</figcaption>
      </figure> 
      </td> 
    <td class="vf-table__cell">
      <figure class="vf-figure">
        <img class="vf-figure__image" src="{{ study.example_annotation_uri }}" alt="Example annotation for this dataset">
        <figcaption class="vf-figure__caption">Example annotation for this dataset</figcaption>
      </figure>
    </td>
    </tr> 
    </table>
      </div>

  </div>

    <!-- Study Information --> 
  <section class="embl-grid embl-grid--has-centered-content">
    <div class="vf-section-header">
      <h3 class="vf-section-header__heading" id="study">Study Information</h3>
      <p></p>
       <a class="vf-card__link" href="https://www.ebi.ac.uk/biostudies/BioImages/studies/{{ study.accession_id }}" target=”_blank”> Original submission page </a>
    </div>
    <div class="vf-content">
      <div class="vf-grid vf-grid__col-2">
            <div><b>Study Summary</b></div>
            <div>{{ study.attributes["one_summary"] }}</div>
           <div><b>Organism</b></div>
            <div>{{ study.organism }}</div>
            <div><b>Study type</b></div>
            <div>{{ study.attributes["study_type"] }}</div>
            <div><b>Imaging type</b></div>
            <div>{{ study.imaging_type }}</div>
        </div>
    </div>
  </section>

<p></p>
        
    <!-- Images -->
    <section class="vf-content | embl-grid embl-grid--has-centered-content">
    <div>
      <h2 class="vf-section-header__heading" id="images">Viewable images</h2>
    </div>
    <div>

        {# <section> #}
                        
                    <table id="viewable">
                        {# <caption class="vf-table__caption">Images with OME-NGFF representations</caption> #}
                        {# <colgroup>
                              <col span="1" style="width: 20%;">
                              <col span="1" style="width: 40%;">
                              <col span="1" style="width: 30%;">
                              <col span="1" style="width: 10%;">
                        </colgroup> #}
                        <thead>
                            <tr>
                                <th>Image ID</th>
                                <th>Preview</th>
                                <th>Filename</th>
                                <th>Dimensions<br>(T, C, Z, Y, X)</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for image in images %}
                            <tr>
                                <td>{{ image_names[image.id] }}</td>
                                <td>
                                    <img class="vf-figure__image" src={{ image_thumbnails[image.id] }}>
                                </td>
                                <td>{{ image.original_relpath }}</td>
                                {% if image.dimensions %}
                                    <td>{{ image.dimensions }}</td>
                                {% elif image.attributes.get('SizeX') %}
                                    <td> ({{ image.attributes['SizeT'] }}, {{ image.attributes['SizeC'] }}, {{ image.attributes['SizeZ'] }}, {{ image.attributes['SizeY'] }}, {{ image.attributes['SizeX'] }})</td>
                                {% else %}
                                    <td> None </td>
                                {% endif %}
                                <td>
                                    <a href={{ landing_uris[image.id] }}><button class="vf-button vf-button--sm vf-button--icon">view</button><a>
                                    <a href={{ image_download_uris[image.id] }}><button class="vf-button vf-button--sm vf-button--icon">download</button></a>
                                </td>                            
                            </tr>
                            {% endfor %}
                        </tbody>
                      </table>
                      {# </section> #}
                    </div>
                    
                    <div>
                    </div>
            </section>

    <!-- Annotations --> 
  <section class="embl-grid embl-grid--has-centered-content">
    <div class="vf-section-header">
      <h3 class="vf-section-header__heading" id="annotations">Annotations</h3>
    </div>
    <div class="vf-content">
            <table class="display table" id="annot_table">
                        <thead>
                            <tr>
                                <th>Annotation ID</th>
                                <th>Filename</th>
                                <!-- {% if annotation_names %}
                                <th>Source Image</th>
                                {% endif %} -->
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for image in annotation_names %}
                                <td>{{ ann_names[image.id] }}</td>
                                <td>{{ image.original_relpath }}</td>
                                <!--  {% if image.attributes.get('source image') %}
                                <td>{{ image.attributes['source image'] }}</td>
                                {% endif %} -->
                                <td><a href={{ annotation_download_uris[image.id] }}>Download</a></td>
                            </tr>
                            {% endfor %}
                        </tbody>
                      </table>  
        </div>
    </div>
  </section>

    <!-- Models used --> 
  <section class="embl-grid embl-grid--has-centered-content">
    <div class="vf-section-header">
      <h3 class="vf-section-header__heading" id="models">Models</h3>
    </div>
    <div class="vf-content">
      {% for k,v in study.links.items() %}
      {% if 'model' in k or 'code' in k %}
        <div>  {{ k }} :  <a href={{ v }}> {{ v }} </a></div>
      {% endif %}
      {% endfor %} 
      <br>
        </div>
    </div>
  </section>

        <!-- All Images -->
        <section class="embl-grid embl-grid--has-centered-content">
                    <div class="vf-section-header">
                        <h2 class="vf-section-header__heading">All images</h2>
                    </div>
                    <div class="vf-content">
                      <table class="display table" id="table">
                        <thead>
                            <tr>
                                <th>Image ID</th>
                                <th>Filename</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- {% for image in study.images.values() %}
                                <td>{{ image_names[image.id] }}</td>
                                <td>{{ image.original_relpath }}</td>
                                <td><a href={{ image_download_uris[image.id] }}>Download</a></td>
                            </tr>
                            {% endfor %}-->
                            {% for image in non_annotation_names %}
                                <td>{{ image_names[image.id] }}</td>
                                <td>{{ image.original_relpath }}</td>
                                <td><a href={{ image_download_uris[image.id] }}>Download</a></td>
                            </tr>
                            {% endfor %}
                        </tbody>
                      </table>                      
                      </div>
                    </div>
            </section>


        <script>
            $(document).ready( function () {
                $('#table').DataTable( {
                    columnDefs: [
                        { type: 'natural', targets: 0 }
                    ]
                });
            } );
            $(document).ready( function () {
                $('#annot_table').DataTable( {
                    columnDefs: [
                        { type: 'natural', targets: 0 }
                    ]
                });
            } );
            $(document).ready( function () {
                $('#viewable').DataTable( {
                    columnDefs: [
                        { type: 'natural', targets: 0 }
                    ]
                });
            } );
        </script>
    </body>
</html>